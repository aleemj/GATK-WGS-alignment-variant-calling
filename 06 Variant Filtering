#If enough variants (>10M), use VQSR:
gatk VariantRecalibrator \
  -R reference/genome.fa \
  -V vcf/raw_variants.vcf.gz \
  --resource:known,known=true,training=true,truth=true,prior=15.0 vcf/bootstrap_snps.vcf.gz \
  -an QD -an MQ -an FS -an SOR -mode SNP \
  -O vcf/recalibrate_SNP.recal \
  --tranches-file vcf/recalibrate_SNP.tranches

gatk ApplyVQSR \
  -R reference/genome.fa \
  -V vcf/raw_variants.vcf.gz \
  --recal-file vcf/recalibrate_SNP.recal \
  --tranches-file vcf/recalibrate_SNP.tranches \
  -mode SNP \
  -O vcf/final_snps.vcf.gz

#Otherwise, apply hard filters:
gatk VariantFiltration \
  -R reference/genome.fa \
  -V vcf/raw_variants.vcf.gz \
  -O vcf/final_snps.vcf.gz \
  --filter-expression "QD < 2.0 || MQ < 40.0 || FS > 60.0 || SOR > 3.0" \
  --filter-name "SNPFilter"

